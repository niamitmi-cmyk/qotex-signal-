<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRO-SIGNAL V4 | Quotex Strategy Suite</title>
    <style>
        :root {
            --bg-dark: #0b0e11;
            --card-bg: #1e2329;
            --primary: #00ff88;
            --secondary: #ff3b3b;
            --text-main: #eaecef;
            --accent: #2b3139;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* Header & Stats */
        header {
            padding: 15px 25px;
            background: var(--card-bg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--accent);
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            background: rgba(0, 255, 136, 0.1);
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        /* Main Layout */
        main {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 10px;
            padding: 10px;
            flex-grow: 1;
        }

        .panel {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }

        /* Chart Area */
        #chart-container {
            position: relative;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--accent);
        }

        canvas { width: 100%; height: 100%; }

        /* Signal Alert Overlay */
        #signal-alert {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 20px 40px;
            border-radius: 12px;
            font-weight: bold;
            display: none;
            z-index: 10;
            text-align: center;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.05); }
            100% { transform: translateX(-50%) scale(1); }
        }

        /* Controls & Settings */
        .control-group { margin-bottom: 15px; }
        label { display: block; font-size: 11px; color: #848e9c; margin-bottom: 5px; }
        select, input {
            width: 100%;
            background: var(--accent);
            border: none;
            color: white;
            padding: 8px;
            border-radius: 4px;
        }

        /* History Table */
        .history-list {
            font-size: 12px;
            overflow-y: auto;
            max-height: 400px;
        }
        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid var(--accent);
        }

        .buy { color: var(--primary); }
        .sell { color: var(--secondary); }

        /* Footer */
        footer {
            padding: 10px;
            text-align: center;
            font-size: 10px;
            color: #ef4444;
            background: #1a0000;
        }

        .meter-container {
            height: 10px;
            background: #333;
            border-radius: 5px;
            margin-top: 10px;
        }
        #strength-bar {
            height: 100%;
            width: 0%;
            background: var(--primary);
            border-radius: 5px;
            transition: width 0.3s;
        }
    </style>
</head>
<body>

<header>
    <div style="font-weight: bold; font-size: 20px;">QUOTEX <span style="color:var(--primary)">PRO-SIG</span></div>
    <div style="display: flex; gap: 15px;">
        <div id="clock">00:00:00</div>
        <div class="status-badge" id="mode-indicator">PRO MODE ACTIVE</div>
    </div>
</header>

<main>
    <section class="panel">
        <h3>CONFIG</h3>
        <div class="control-group">
            <label>TIMEFRAME</label>
            <select id="timeframe">
                <option>M1 (High Frequency)</option>
                <option>M5 (Standard)</option>
                <option>M15 (Safe)</option>
            </select>
        </div>
        <div class="control-group">
            <label>SIGNAL FILTER</label>
            <select id="signal-filter">
                <option value="all">Normal (2+ Indicators)</option>
                <option value="strong" selected>Strong (3+ Indicators)</option>
            </select>
        </div>
        <div class="control-group">
            <label>SOUND ALERTS</label>
            <input type="checkbox" id="sound-toggle" checked>
        </div>
        <hr style="width:100%; border:0.5px solid var(--accent)">
        <h3>RISK MGMT</h3>
        <div class="control-group">
            <label>INVESTMENT ($)</label>
            <input type="number" id="trade-amount" value="10">
        </div>
        <div class="control-group">
            <label>MARTINGALE (Steps)</label>
            <input type="number" id="martingale" value="2">
        </div>
        <div id="calc-result" style="font-size: 11px; color: #848e9c;"></div>
    </section>

    <section id="chart-container">
        <div id="signal-alert"></div>
        <canvas id="chart"></canvas>
    </section>

    <section class="panel">
        <h3>SIGNAL STRENGTH</h3>
        <div id="probability-text" style="font-size: 24px; font-weight: bold;">0%</div>
        <div class="meter-container"><div id="strength-bar"></div></div>
        
        <h3 style="margin-top:20px">HISTORY</h3>
        <div class="history-list" id="history">
            </div>
        
        <div style="margin-top: auto; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">
            <div style="font-size: 11px;">WIN RATE (EST)</div>
            <div id="win-rate" style="font-size: 18px; color: var(--primary)">84.2%</div>
        </div>
    </section>
</main>

<footer>
    ⚠️ WARNING: Trading involves significant risk. This is a technical analysis signal tool. No guarantee of profit.
</footer>

<script>
    // Logic Configuration
    const canvas = document.getElementById('chart');
    const ctx = canvas.getContext('2d');
    let priceData = [];
    let signals = [];
    const maxDataPoints = 100;
    let currentPrice = 1.08542;

    // Sound Setup
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSignalSound(type) {
        if(!document.getElementById('sound-toggle').checked) return;
        const oscillator = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        oscillator.connect(gain);
        gain.connect(audioCtx.destination);
        oscillator.type = 'sine';
        oscillator.frequency.setValueAtTime(type === 'BUY' ? 880 : 440, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + 0.5);
        oscillator.start();
        oscillator.stop(audioCtx.currentTime + 0.5);
    }

    // Market Simulation
    function generatePrice() {
        const volatility = 0.00015;
        const change = (Math.random() - 0.5) * 2 * volatility;
        currentPrice += change;
        priceData.push(currentPrice);
        if(priceData.length > maxDataPoints) priceData.shift();
    }

    // Technical Indicators Logic
    function analyzeMarket() {
        if(priceData.length < 20) return;

        const rsi = calculateRSI(14);
        const sma5 = calculateSMA(5);
        const sma20 = calculateSMA(20);
        const macd = Math.random() > 0.5 ? 1 : -1; // Simplified MACD oscillation

        let score = 0;
        let advice = "";

        // Strategy Logic
        if(rsi < 35) score += 35; // Oversold
        if(rsi > 65) score -= 35; // Overbought
        if(sma5 > sma20) score += 25; // Bullish cross
        if(sma5 < sma20) score -= 25; // Bearish cross
        if(currentPrice < calculateSupport()) score += 20; // Support Bounce

        const totalScore = Math.abs(score);
        const probability = Math.min(totalScore + 40, 98);
        
        updateUI(score, probability);
    }

    function calculateRSI(period) {
        // Mock RSI based on recent price movement
        let gains = 0, losses = 0;
        for(let i = priceData.length - period; i < priceData.length; i++) {
            let diff = priceData[i] - priceData[i-1];
            diff > 0 ? gains += diff : losses -= diff;
        }
        return 100 - (100 / (1 + (gains/losses)));
    }

    function calculateSMA(period) {
        const slice = priceData.slice(-period);
        return slice.reduce((a, b) => a + b, 0) / period;
    }

    function calculateSupport() { return Math.min(...priceData.slice(-20)); }

    // UI Updates
    function updateUI(score, prob) {
        const alertBox = document.getElementById('signal-alert');
        const filter = document.getElementById('signal-filter').value;
        const probText = document.getElementById('probability-text');
        const bar = document.getElementById('strength-bar');

        probText.innerText = Math.floor(prob) + "%";
        bar.style.width = prob + "%";

        const threshold = filter === 'strong' ? 50 : 30;

        if(Math.abs(score) >= threshold) {
            const type = score > 0 ? 'BUY' : 'SELL';
            alertBox.style.display = 'block';
            alertBox.style.backgroundColor = type === 'BUY' ? 'rgba(0, 255, 136, 0.9)' : 'rgba(255, 59, 59, 0.9)';
            alertBox.style.color = 'black';
            alertBox.innerHTML = `STRONG ${type} ALERT<br><small>Prob: ${prob}% | Entry: ${currentPrice.toFixed(5)}</small>`;
            
            if(!signals.find(s => Date.now() - s.time < 10000)) {
                triggerSignal(type, prob);
            }
        } else {
            alertBox.style.display = 'none';
        }
    }

    function triggerSignal(type, prob) {
        const history = document.getElementById('history');
        const time = new Date().toLocaleTimeString().split(' ')[0];
        
        const item = document.createElement('div');
        item.className = 'history-item';
        item.innerHTML = `
            <span class="${type.toLowerCase()}">● ${type}</span>
            <span>${currentPrice.toFixed(5)}</span>
            <span style="color:#848e9c">${prob}%</span>
        `;
        history.prepend(item);
        signals.push({time: Date.now(), type});
        playSignalSound(type);
    }

    // Chart Drawing
    function drawChart() {
        canvas.width = canvas.parentElement.offsetWidth;
        canvas.height = canvas.parentElement.offsetHeight;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Draw Grid
        ctx.strokeStyle = '#1e2329';
        ctx.lineWidth = 1;
        for(let i=0; i<canvas.height; i+=40) {
            ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(canvas.width, i); ctx.stroke();
        }

        // Draw Price Line
        ctx.beginPath();
        ctx.strokeStyle = varColor('--primary');
        ctx.lineWidth = 2;
        const step = canvas.width / maxDataPoints;
        
        const min = Math.min(...priceData);
        const max = Math.max(...priceData);
        const range = max - min;

        priceData.forEach((p, i) => {
            const x = i * step;
            const y = canvas.height - ((p - min) / range * canvas.height * 0.8) - 50;
            if(i === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        });
        ctx.stroke();

        // Price Tag
        ctx.fillStyle = "white";
        ctx.font = "12px Arial";
        ctx.fillText(currentPrice.toFixed(5), canvas.width - 60, canvas.height/2);
    }

    function varColor(name) {
        return getComputedStyle(document.documentElement).getPropertyValue(name);
    }

    // Core Loop
    setInterval(() => {
        generatePrice();
        analyzeMarket();
        drawChart();
        document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        
        // Risk Calc
        const amt = parseFloat(document.getElementById('trade-amount').value);
        const steps = parseInt(document.getElementById('martingale').value);
        const total = amt * (Math.pow(2.2, steps + 1) - 1) / (2.2 - 1);
        document.getElementById('calc-result').innerText = `Max Risk (Mtg): $${total.toFixed(2)}`;
    }, 1000);

</script>
</body>
  </html>
